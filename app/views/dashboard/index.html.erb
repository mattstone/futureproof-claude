<div class="application-header">
  <h1 class="application-title">Dashboard</h1>
  <p class="application-subtitle">Manage your Equity Preservation Mortgage® applications and account details</p>
</div>

<div class="dashboard-sections">
          
          <!-- Account Information -->
          <div class="summary-section">
            <h3 class="summary-section-title">Account Information</h3>
            <div class="summary-grid">
              <div class="summary-item">
                <span class="summary-label">Name:</span>
                <span class="summary-value"><%= current_user.full_name %></span>
              </div>
              <div class="summary-item">
                <span class="summary-label">Email:</span>
                <span class="summary-value"><%= current_user.email %></span>
              </div>
              <% if current_user.full_mobile_number.present? %>
                <div class="summary-item">
                  <span class="summary-label">Mobile:</span>
                  <span class="summary-value"><%= current_user.full_mobile_number %></span>
                </div>
              <% end %>
              <div class="summary-item">
                <span class="summary-label">Account Created:</span>
                <span class="summary-value"><%= current_user.created_at.strftime("%B %d, %Y") %></span>
              </div>
              <div class="summary-item">
                <span class="summary-label">Email Verified:</span>
                <span class="summary-value">
                  <% if current_user.confirmed? %>
                    <span class="badge badge-success">✓ Verified</span>
                  <% else %>
                    <span class="badge badge-warning">⚠ Pending Verification</span>
                  <% end %>
                </span>
              </div>
            </div>
            <div class="section-actions">
              <%= link_to "Update Account Details", edit_user_registration_path, class: "btn btn-outline-primary" %>
            </div>
          </div>

          <!-- Current Application -->
          <% if @current_application %>
            <div class="summary-section">
              <h3 class="summary-section-title">Current Application</h3>
              <div class="application-status-card">
                <div class="status-header">
                  <div class="status-info">
                    <h4>Application #<%= @current_application.id.to_s.rjust(6, '0') %></h4>
                    <span class="status-badge <%= @current_application.status_badge_class %>">
                      <%= @current_application.status_display %>
                    </span>
                  </div>
                  <div class="progress-indicator">
                    <div class="progress-bar">
                      <div class="progress-fill" style="width: <%= @current_application.progress_percentage %>%"></div>
                    </div>
                    <span class="progress-text"><%= @current_application.progress_percentage %>% Complete</span>
                  </div>
                </div>
                
                <div class="application-details">
                  <div class="detail-item">
                    <span class="detail-label">Property Address:</span>
                    <span class="detail-value"><%= @current_application.address || "Not provided" %></span>
                  </div>
                  <div class="detail-item">
                    <span class="detail-label">Property Value:</span>
                    <span class="detail-value"><%= @current_application.home_value ? @current_application.formatted_home_value : "Not provided" %></span>
                  </div>
                  <% if @current_application.mortgage.present? %>
                    <div class="detail-item">
                      <span class="detail-label">Mortgage Type:</span>
                      <span class="detail-value"><%= @current_application.mortgage.name %></span>
                    </div>
                  <% end %>
                  <div class="detail-item">
                    <span class="detail-label">Last Updated:</span>
                    <span class="detail-value"><%= @current_application.updated_at.strftime("%B %d, %Y at %I:%M %p") %></span>
                  </div>
                </div>

                <div class="application-actions">
                  <% case @current_application.status %>
                  <% when 'property_details' %>
                    <%= link_to "Continue Property Details", edit_application_path(@current_application), class: "btn btn-primary" %>
                  <% when 'income_and_loan_options' %>
                    <%= link_to "Continue Income & Loan", income_and_loan_application_path(@current_application), class: "btn btn-primary" %>
                    <%= link_to "Review Summary", summary_application_path(@current_application), class: "btn btn-outline-primary" %>
                  <% else %>
                    <%= link_to "View Details", @current_application, class: "btn btn-outline-primary" %>
                  <% end %>
                </div>
              </div>
            </div>
          <% else %>
            <div class="summary-section">
              <h3 class="summary-section-title">No Active Applications</h3>
              <div class="empty-state">
                <p>You don't have any applications in progress. Ready to get started?</p>
                <div class="empty-state-actions">
                  <%= link_to "Start New Application", "/start-application", class: "btn btn-primary" %>
                </div>
              </div>
            </div>
          <% end %>

          <!-- Application History -->
          <% if @submitted_applications.any? %>
            <div class="summary-section">
              <h3 class="summary-section-title">Application History</h3>
              <div class="applications-list">
                <% @submitted_applications.each do |application| %>
                  <div class="application-history-item">
                    <div class="history-header">
                      <div class="history-info">
                        <h5>Application #<%= application.id.to_s.rjust(6, '0') %></h5>
                        <span class="status-badge <%= application.status_badge_class %>">
                          <%= application.status_display %>
                        </span>
                      </div>
                      <div class="history-date">
                        Submitted <%= application.updated_at.strftime("%B %d, %Y") %>
                      </div>
                    </div>
                    
                    <div class="history-details">
                      <div class="detail-row">
                        <span class="detail-label">Property:</span>
                        <span class="detail-value"><%= application.address %></span>
                      </div>
                      <div class="detail-row">
                        <span class="detail-label">Value:</span>
                        <span class="detail-value"><%= application.formatted_home_value %></span>
                      </div>
                      <% if application.mortgage.present? %>
                        <div class="detail-row">
                          <span class="detail-label">Mortgage Type:</span>
                          <span class="detail-value"><%= application.mortgage.name %></span>
                        </div>
                      <% end %>
                    </div>

                    <div class="history-actions">
                      <%= link_to "View Details", application, class: "btn btn-outline-secondary btn-sm" %>
                      <% if application.status_submitted? %>
                        <%= link_to "View Summary", summary_application_path(application), class: "btn btn-outline-primary btn-sm" %>
                      <% end %>
                    </div>
                  </div>
                <% end %>
              </div>
            </div>
          <% end %>

        </div>

<% content_for :help_section do %>
  <%= render 'shared/account_help' %>
<% end %>