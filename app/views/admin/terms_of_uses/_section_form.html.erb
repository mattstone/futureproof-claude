<%
  section ||= {}
  index = defined?(index) ? index : 0
  section_type = section['type'] || 'section'
%>

<div class="section-form section-<%= section_type %>">
  <div class="section-header">
    <select name="terms_of_use[sections][<%= index %>][type]" class="section-type-selector">
      <option value="section" <%= 'selected' if section_type == 'section' %>>Standard Section</option>
      <option value="contact" <%= 'selected' if section_type == 'contact' %>>Contact Information</option>
    </select>
    
    <button type="button" class="remove-section-btn">Remove Section</button>
  </div>

  <div class="section-field">
    <label>Section Title</label>
    <input type="text" 
           name="terms_of_use[sections][<%= index %>][title]" 
           value="<%= section['title'] %>" 
           placeholder="e.g., 1. Acceptance of Terms">
  </div>

  <div class="standard-fields" style="<%= 'display: none;' if section_type == 'contact' %>">
    <div class="section-field">
      <label>Content</label>
      <textarea name="terms_of_use[sections][<%= index %>][content]" 
                placeholder="Main content for this section"><%= section['content'] %></textarea>
    </div>

    <div class="section-field">
      <label>List Items (optional)</label>
      <div class="items-container">
        <div class="items-list">
          <% if section['items']&.any? %>
            <% section['items'].each do |item| %>
              <div class="item-input">
                <input type="text" 
                       name="terms_of_use[sections][<%= index %>][items][]" 
                       value="<%= item %>" 
                       placeholder="Enter item text">
                <button type="button" class="remove-item-btn">Remove</button>
              </div>
            <% end %>
          <% end %>
        </div>
        <button type="button" class="add-item-btn">+ Add Item</button>
      </div>
    </div>

    <div class="section-field">
      <label>Additional Content (optional)</label>
      <textarea name="terms_of_use[sections][<%= index %>][additional_content]" 
                placeholder="Additional content after the list"><%= section['additional_content'] %></textarea>
    </div>
  </div>

  <div class="contact-fields" style="<%= 'display: none;' if section_type != 'contact' %>">
    <div class="section-field">
      <label>Introduction Text</label>
      <textarea name="terms_of_use[sections][<%= index %>][content]" 
                placeholder="e.g., If you have any questions, please contact us at:"><%= section['content'] %></textarea>
    </div>

    <div class="contact-info-fields">
      <div class="section-field">
        <label>Company Name</label>
        <input type="text" 
               name="terms_of_use[sections][<%= index %>][contact_info][company]" 
               value="<%= section.dig('contact_info', 'company') %>" 
               placeholder="Company Name">
      </div>
      
      <div class="section-field">
        <label>Email</label>
        <input type="email" 
               name="terms_of_use[sections][<%= index %>][contact_info][email]" 
               value="<%= section.dig('contact_info', 'email') %>" 
               placeholder="contact@company.com">
      </div>
      
      <div class="section-field">
        <label>Address</label>
        <input type="text" 
               name="terms_of_use[sections][<%= index %>][contact_info][address]" 
               value="<%= section.dig('contact_info', 'address') %>" 
               placeholder="Physical Address">
      </div>
    </div>
  </div>
</div>