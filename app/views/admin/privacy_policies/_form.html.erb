<%= form_with model: [:admin, @privacy_policy], local: true, class: "admin-form" do |form| %>
  <% if @privacy_policy.errors.any? %>
    <div class="alert alert-danger">
      <h4><%= pluralize(@privacy_policy.errors.count, "error") %> prohibited this Privacy Policy from being saved:</h4>
      <ul>
        <% @privacy_policy.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="admin-form-group">
    <%= form.label :title, class: "admin-form-label" %>
    <%= form.text_field :title, class: "admin-form-input", placeholder: "e.g., Privacy Policy" %>
  </div>

  <div class="csp-spacer-20"></div>

  <div class="admin-form-group">
    <% if @privacy_policy.persisted? %>
      <label class="admin-form-label">Version</label>
      <div class="admin-form-input csp-readonly-field">
        Version <%= @privacy_policy.version %>
      </div>
    <% else %>
      <label class="admin-form-label">Version</label>
      <div class="admin-form-input csp-readonly-field">
        Version <%= (PrivacyPolicy.maximum(:version) || 0) + 1 %> (new version)
      </div>
    <% end %>
  </div>

  <div class="csp-spacer-20"></div>

  <div class="admin-form-group">
    <%= form.label :content, "Content (using simple markup)", class: "admin-form-label" %>
    <div class="markup-help">
      <p><strong>Simple Markup Guide:</strong></p>
      <ul>
        <li><code>## Heading</code> → Creates a main section with heading</li>
        <li><code>### Sub-heading</code> → Creates a sub-section</li>
        <li><code>- Bullet point</code> → Creates bulleted lists</li>
        <li><code>**Bold text**</code> → Makes text bold</li>
        <li><code>**Contact Info:**</code> → Special contact information block</li>
      </ul>
    </div>
    
    <%= form.text_area :content, 
        class: "admin-form-textarea markup-editor", 
        rows: 25,
        placeholder: 'Use simple markup to format your content. See the guide above for examples.',
        data: {
          "markup-editor-target": "editor"
        } %>
  </div>

  <div class="admin-form-actions csp-actions-margin">
    <% if @privacy_policy.persisted? %>
      <%= form.submit "Update Privacy Policy", class: "admin-btn admin-btn-primary" %>
    <% else %>
      <%= form.submit "Create Version #{(PrivacyPolicy.maximum(:version) || 0) + 1}", class: "admin-btn admin-btn-primary" %>
    <% end %>
    <button type="button" 
            data-markup-editor-target="previewButton"
            data-preview-target="button"
            class="admin-btn admin-btn-success">Preview Full Page</button>
    <%= link_to "Cancel", admin_privacy_policies_path, class: "admin-btn admin-btn-secondary" %>
  </div>
<% end %>

