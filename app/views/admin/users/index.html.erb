<% content_for :page_title, "Users" %>

<div class="admin-actions-bar">
  <div class="admin-search">
    <%= form_with(url: admin_users_path, method: :get, local: true, class: "search-form") do |form| %>
      <%= form.text_field :search, placeholder: "Search users...", value: params[:search] %>
    <% end %>
  </div>
  
  <div class="admin-actions">
    <%= link_to "Add New User", new_admin_user_path, class: "admin-btn admin-btn-primary" %>
  </div>
</div>

<div class="admin-table">
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Country</th>
        <th>Role</th>
        <th style="text-align: center;">Terms Version</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @users.each do |user| %>
        <tr>
          <td><%= user.display_name %></td>
          <td><%= user.email %></td>
          <td><%= user.country_of_residence %></td>
          <td>
            <% if user.admin? %>
              <span class="admin-badge admin-badge-admin">Admin</span>
            <% else %>
              <span class="admin-badge admin-badge-user">User</span>
            <% end %>
          </td>
          <td style="text-align: center;">
            <% if user.terms_version %>
              <span class="admin-badge admin-badge-info"><%= user.terms_version %></span>
            <% else %>
              <span class="admin-badge admin-badge-secondary">-</span>
            <% end %>
          </td>
          <td>
            <% if user.confirmed? %>
              <span class="admin-badge admin-badge-user">Confirmed</span>
            <% else %>
              <span class="admin-badge admin-badge-admin">Pending</span>
            <% end %>
          </td>
          <td>
            <%= link_to "View", admin_user_path(user), class: "admin-btn admin-btn-sm admin-btn-secondary" %>
            <%= link_to "Edit", edit_admin_user_path(user), class: "admin-btn admin-btn-sm admin-btn-primary" %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
  
  <% if @users.empty? %>
    <div style="padding: 40px; text-align: center; color: #6b7280;">
      <% if params[:search].present? %>
        No users found matching "<%= params[:search] %>"
      <% else %>
        No users found.
      <% end %>
    </div>
  <% end %>
</div>

<div class="admin-pagination">
  <%= paginate @users %>
</div>