<% content_for :page_title, "CoreLogic Search Results" %>

<div class="admin-actions-bar">
  <%= link_to "← Back to Search", admin_core_logic_test_index_path, class: "admin-btn admin-btn-secondary" %>
</div>

<div class="dashboard-card">
  <div class="card-header">
    <h3>Search Results for "<%= params[:query] %>"</h3>
  </div>
  <div class="card-content">
    <% if @suggestions && @suggestions.is_a?(Array) && @suggestions.any? %>
      <div class="admin-table-container">
        <table class="admin-table">
          <thead>
            <tr>
              <th>Property Suggestion</th>
              <th>Property ID</th>
              <th>Type</th>
              <th>Active</th>
              <th>Unit</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% @suggestions.each do |suggestion| %>
              <tr>
                <td>
                  <strong><%= suggestion['suggestion'] %></strong>
                </td>
                <td>
                  <code><%= suggestion['property_id'] || suggestion['propertyId'] %></code>
                </td>
                <td>
                  <span class="status-badge">
                    <%= suggestion['suggestion_type'] || suggestion['suggestionType'] || 'Property' %>
                  </span>
                </td>
                <td>
                  <% is_active = suggestion['is_active_property'] || suggestion['isActiveProperty'] %>
                  <span class="status-badge <%= is_active ? 'status-active' : 'status-inactive' %>">
                    <%= is_active ? 'Active' : 'Inactive' %>
                  </span>
                </td>
                <td>
                  <% is_unit = suggestion['is_unit'] || suggestion['isUnit'] %>
                  <span class="status-badge <%= is_unit ? 'status-info' : 'status-neutral' %>">
                    <%= is_unit ? 'Unit' : 'House' %>
                  </span>
                </td>
                <td>
                  <% property_id = suggestion['property_id'] || suggestion['propertyId'] %>
                  <% if property_id %>
                    <%= link_to "View Details",
                        property_details_admin_core_logic_test_index_path(property_id: property_id),
                        class: "admin-btn admin-btn-primary" %>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% elsif @suggestions && @suggestions.is_a?(Hash) && @suggestions['error'] %>
      <div class="alert alert-error">
        <strong>Error:</strong> <%= @suggestions['error'] %>
      </div>
    <% else %>
      <div class="alert alert-info">
        No property suggestions found for "<%= params[:query] %>".
      </div>
    <% end %>
  </div>
</div>