<% content_for :title, "New Workflow" %>
<% content_for :breadcrumb do %>
  <%= link_to "Workflows", admin_email_workflows_path, class: "breadcrumb-link" %>
  <span class="breadcrumb-separator">â†’</span>
  <span>New Workflow</span>
<% end %>

<div class="workflow-form-container" data-controller="workflow-mode">
  <div class="workflow-form-header">
    <h1>Create New Workflow</h1>
    <p>Build automated email sequences to engage customers throughout their lifecycle.</p>
    
    <% if current_user&.admin? %>
      <div class="admin-info-box admin-info-box-blue">
        <p class="admin-info-text">
          <strong>ğŸš€ Try the New Business Process Workflow Systems:</strong>
        </p>
        <div class="admin-button-group">
          <%= link_to admin_business_process_workflows_path, class: "admin-btn admin-site-btn-primary admin-btn-sm" do %>
            ğŸ¨ Visual Builder (v2)
          <% end %>
          <%= link_to admin_workflow_forms_path, class: "admin-btn admin-btn-success admin-btn-sm" do %>
            ğŸ“ Form Builder (Simple)
          <% end %>
        </div>
        <p class="admin-info-subtext">
          These new systems support complex conditional workflows with multiple triggers per business process.
        </p>
      </div>
    <% end %>
    
    <div class="builder-mode-toggle">
      <button type="button" class="mode-btn active" data-mode="visual" 
              data-workflow-mode-target="modeBtn" 
              data-action="click->workflow-mode#switchToMode">
        <i class="fas fa-project-diagram"></i> Visual Builder
      </button>
      <button type="button" class="mode-btn" data-mode="form" 
              data-workflow-mode-target="modeBtn" 
              data-action="click->workflow-mode#switchToMode">
        <i class="fas fa-list"></i> Traditional Form
      </button>
    </div>
  </div>

  <!-- Visual Builder Mode (Default) -->
  <div class="builder-mode" data-workflow-mode-target="visualMode">
    <%= render 'visual_builder', workflow: @workflow %>
  </div>

  <!-- Traditional Form Mode -->
  <div class="builder-mode hidden" data-workflow-mode-target="formMode">
    <%= render 'form', workflow: @workflow %>
  </div>
</div>


